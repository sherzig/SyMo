<?xml version="1.0" encoding="UTF-8" standalone="no" ?><File ModelCenterVersion="10.0.1" type="Phoenix Integration ModelCenter File" version="3.0" xml:space="preserve"><Model UUID="b8vkb1aadv2ft3zywqywubezfjq4cn3gunah74j3mbhijosulklkgvokajy2l7un4rkga23byr1j45r8hegsmo5a0vjzs7c6cfql71smfbpvv6b7pxoec44q631bxzxg"><Assembly name="motorModelScript" type="Assembly"><Properties><Property name="index">-1</Property><Property name="author">Brian</Property><Property name="date">7/21/2011</Property><Property name="version"></Property><Property name="description"></Property><Property name="componentRequirements"></Property><Property name="accumulatedRequirements"></Property><Property name="helpURL"></Property><Property name="keywords"></Property><Property name="custIcon"></Property><Property name="xposition">20</Property><Property name="yposition">20</Property><Property name="width">0</Property><Property name="height">0</Property><Property name="source"></Property><Property name="connector"></Property><Property name="queue"></Property><Property name="useDefaultQueue">false</Property><Property name="queueList"></Property><Property name="driverAutorun">false</Property><Property name="driverPriority">0</Property><Property name="syncInputs">false</Property><Property name="onInputChange">0</Property><Property name="runStatistics"></Property><Property name="allowInvalidDataAccess">false</Property><Property name="logLevel">30</Property><Property name="inheritParentLogLevel">false</Property><Property name="jobUUID"></Property><Property name="Top">0</Property><Property name="Left">0</Property><Property name="AnalysisView"><AnalysisView autoNSquared="false" bkMode="color" color="176,182,240" diagramStyle="classic" layout="0" showBorders="true" showLinks="true" snapToGrid="false" xml:space="preserve"><control box="295,236,346,273" collapsed="true" component=".\Script" layout="0" name="Script" oldBox="0,0,100,100" type="Component" visible="true"/></AnalysisView></Property><Property name="Zoom">100</Property></Properties><Component name="Script" type="Component"><Properties><Property name="index">0</Property><Property name="author">Phoenix Integration</Property><Property name="date">11/3/2011</Property><Property name="version">1.0</Property><Property name="description">user-defined component</Property><Property name="componentRequirements"></Property><Property name="accumulatedRequirements"></Property><Property name="helpURL">www.phoenix-int.com</Property><Property name="keywords"></Property><Property name="custIcon"></Property><Property name="xposition">295</Property><Property name="yposition">236</Property><Property name="width">0</Property><Property name="height">0</Property><Property name="source">common:\\Functions\\Script</Property><Property name="connector"></Property><Property name="queue"></Property><Property name="useDefaultQueue">false</Property><Property name="queueList"></Property><Property name="driverAutorun">false</Property><Property name="driverPriority">0</Property><Property name="syncInputs">false</Property><Property name="onInputChange">0</Property><Property name="runStatistics">,0.000496543813577228</Property><Property name="allowInvalidDataAccess">false</Property><Property name="logLevel">30</Property><Property name="inheritParentLogLevel">true</Property><Property name="scriptSource">sub run\r\n\r\n' motor_MC.m\r\n' \r\n' Given the following variables, this will comput the stall torque [Nm] and\r\n' max rotational speed [rad/s] of a permenant magnet brushless DC electric\r\n' motor.\r\n' \r\n' This file is built to be used from within ModelCenter to optimize an\r\n' electric motor.\r\n' \r\n' ModelCenter Variable Definition\r\n' variable: powerMax double output\r\n' variable: omegaMax double output\r\n' variable: D_1in double input\r\n' variable: D_w double input\r\n' variable: l double input\r\n' variable: kD1 double input\r\n' variable: kD2 double input\r\n\r\n' %%%%%%%%%%%%%%%%%%%%%%%%%%%% function %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\r\n' Motor Parameters\r\nDim m_1\r\nm_1 = 3                        ' number of phases\r\nDim poles\r\npoles = 9                      ' number of poles\r\nDim p\r\np = poles/2                    \r\nDim alpha\r\nalpha = 0.84\r\nDim pi\r\npi=3.14                   ' Pole pitch to shoe width ratio\r\nDim k_f\r\nk_f = (4/pi)*sin(alpha*pi/2)   ' exitation field form factor\r\nDim mu_not\r\nmu_not = 0.4*pi*10^-6          ' mag perm of free space\r\nDim mu_rrec\r\nmu_rrec = 1.05                 ' relative recoil permiability\r\nDim B_r\r\nB_r = 1.45                     ' remenance magnetic field (Neodymium Iron Boron)(T)\r\nDim k_w\r\nk_w = 0.926                    ' winding factor\r\nDim k_p\r\nk_p = pi*(3^0.5)/6             ' packing factor\r\nDim k_g\r\nk_g = 0.98                     ' gap coefficient--changed from 0.95, gap was too large CJP\r\nDim rho_w\r\nrho_w = 1.68*10^(-8)           ' resistivity of copper (ohm*meter)\r\nDim density_steel\r\ndensity_steel = 7850           ' density of steel (kg/m^3)\r\nDim density_copper\r\ndensity_copper = 8940          ' density of copper (kg/m^3)\r\nDim density_magnet\r\ndensity_magnet = 7500          ' density of Neodymium Iron Boron (kg/m^3)\r\nDim k_c\r\nk_c = 1.1    ' confirm value!  ' Carters coefficient k_c &gt; 1\r\nDim k_sat\r\nk_sat = 1.1  ' confirm value!  ' saturation factor k_sat &gt; 1\r\nDim Rexternal\r\nRexternal = 1                  ' resistance of all the external components --CJP\r\n\r\n' Geometry\r\n' D_1in = 0.132                ' stator interior diameter\r\nDim r_1in\r\nr_1in = D_1in/2\r\nDim D_1out\r\nD_1out = kD1*D_1in             ' stator exterior diameter\r\nDim r_1out\r\nr_1out = D_1out/2\r\nDim D_2out\r\nD_2out =  k_g*D_1in            ' rotor exterior diameter\r\nDim r_2out\r\nr_2out = D_2out/2\r\nDim D_2in\r\nD_2in = kD2*D_2out              ' rotor interior diameter\r\nDim r_2in\r\nr_2in = D_2in/2\r\nDim g\r\ng = r_1in - r_2out             ' air gap distance -- changed CJP\r\nDim r_w\r\nr_w = D_w/2\r\n\r\n' Functions\r\n\r\n' Motor Constants\r\nDim tau\r\ntau = pi*D_1in/(2*p) ' pole pitch\r\nDim b_p\r\nb_p = alpha*tau    ' pole shoe width\r\nDim h_a\r\nh_a =  r_1out - r_1in ' armature pole length\r\nDim N_p\r\n\r\nIf r_w &lt;&gt; 0 Then\t' In VBScript &lt;&gt; means \"not equal to\"\r\n\tN_p = Int(0.225*tau*k_p*(r_1out-r_1in)/(pi*r_w^2)) ' number of windings per armature pole\r\nElse\r\n\tN_p = 0\r\nEnd If\r\n\r\nDim N\r\nN = 2*p*N_p/m_1 ' number of turns per phase \r\n'% N = 192;   ' number of turns per phase\r\nDim h_m\r\nh_m = r_2out - r_2in  ' magnet thickness\r\nDim B_mg\r\n\r\nIf h_m &lt;&gt; 0 Then\r\n\tB_mg = B_r/(1 + mu_rrec*(g/h_m)) \r\nElse\r\n\tB_mg = 0\r\nEnd If\r\n'% B_mg = 0.923; ' max B in air gap\r\nDim B_mg1\r\nB_mg1 = k_f*B_mg ' B_mg at fundamental harmonic\r\nDim phi_f\r\nphi_f = (2/pi)*tau*l*B_mg1 ' excitation flux\r\nDim phi_f_sq\r\nphi_f_sq = b_p*l*B_mg\r\nDim kE\r\nkE = 8*p*N_p*k_w*phi_f_sq/(2*pi)  'using N_p% EMF constant (V-s)\r\n'% kE = 8*p*N*k_w*phi_f_sq/(2*pi)  ' EMF constant (V-s)\r\nDim kT\r\nkT = kE ' torque constant (Nm/A)\r\n\r\n' Resistance\r\nDim l_w\r\nl_w = N_p*(2*(l + 0.3*tau) + 2*0.7*tau)*3*3 ' times 9 since there are thre poles per phase and 3 phases\r\nDim A_w\r\nA_w = pi*r_w^2\r\n\r\n' assume that the total resistance is the resistance of the\r\n' external components + the resistance of the wire -- CJP\r\nDim Resistance_w\r\n\r\nIf A_w &lt;&gt; 0 Then\r\n\tResistance_w = rho_w*l_w/A_w\r\nElse\r\n\tResistance_w = 0\r\nEnd If\r\n\r\nDim Rtotal\r\nRtotal = Rexternal + Resistance_w\r\n\r\n' Inductance\r\n' armature inductance\r\nDim g_prime\r\ng_prime = k_c*k_sat*g + (h_m/mu_rrec)\r\nDim L_a\r\n\r\nIf g_prime &lt;&gt; 0 Then\r\n\tL_a = mu_not*(pi/12)*(D_1in/g_prime)*(alpha^3)*l*(N/(4*p*3))^2\r\nElse\r\n\tL_a = 0\r\nEnd If\r\n\r\n' Mass\r\nDim Ao\r\nAo = 0.225*tau*k_p*(r_1out-r_1in) '% cross sectional area taken up by one side of a winding\r\nDim v1\r\nv1 = (pi*(r_1out*r_1out - r_1in*r_1in) - 4*Ao*(poles+1))*l  '% stator volume (4 should be 2, but numbers are too big)\r\nDim v2\r\nv2 = pi*(r_2out*r_2out - r_2in*r_2in)*l '% rotor volume\r\nDim vol_wire\r\nvol_wire = A_w*l_w 'volume of windings\r\nDim mass_stator\r\nmass_stator = v1*density_steel\r\nDim mass_rotor\r\nmass_rotor = v2*density_magnet\r\nDim mass_wire\r\nmass_wire = vol_wire*density_copper\r\nDim mass\r\nmass = mass_stator + mass_rotor + mass_wire\r\n\r\n'Moment of inertia\r\nDim Inertia\r\nInertia = 0.5*mass*(r_2out*r_2out + r_2in*r_2in)\r\n\r\n' T = kT*I_rms_sq;    % torque (Nm)\r\n' E = kE*omega;      % EMF  (V)\r\n\r\nDim V\r\nV = 500\r\nDim b\r\nb = 0.1\r\nDim I\r\nI = V/Rtotal\r\nP = I*V\r\nDim tauStall\r\n\r\nif N_p = 0 then\r\n    tauStall = 0\r\n    omegaMax = 0\r\nelse\r\n    tauStall = kT*V/Rtotal\r\n    omegaMax = V*kT/(Rtotal*b+kT*kT)  '*(30/pi);\r\nend if\r\n\r\npowerMax = tauStall*omegaMax/4\r\n\r\n\r\n\r\n\r\nend sub\r\n</Property><Property name="scriptInputs">double D_1in,double D_w,double l,double kD1,double kD2</Property><Property name="scriptOutputs">double powerMax,double omegaMax</Property><Property name="scriptTimeout">30</Property><Property name="scriptForwardScheduling">false</Property><Property name="scriptPrevalidate">true</Property><Property name="scriptLanguage">VBScript</Property></Properties><Variable name="D_1in" state="Output" type="double">0<Properties><Property name="index">-1</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Variable name="D_w" state="Output" type="double">0<Properties><Property name="index">-1</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Variable name="l" state="Output" type="double">0<Properties><Property name="index">-1</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Variable name="kD1" state="Output" type="double">0<Properties><Property name="index">-1</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Variable name="kD2" state="Output" type="double">0<Properties><Property name="index">-1</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Variable name="powerMax" state="Output" type="double">0<Properties><Property name="index">-1</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Variable name="omegaMax" state="Output" type="double">0<Properties><Property name="index">-1</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Links><Link name="link0"><Properties><Property name="active">true</Property><Property name="from">..\\D_1in</Property><Property name="to">.\\D_1in</Property></Properties></Link><Link name="link1"><Properties><Property name="active">true</Property><Property name="from">..\\D_w</Property><Property name="to">.\\D_w</Property></Properties></Link><Link name="link2"><Properties><Property name="active">true</Property><Property name="from">..\\l</Property><Property name="to">.\\l</Property></Properties></Link><Link name="link3"><Properties><Property name="active">true</Property><Property name="from">..\\kD1</Property><Property name="to">.\\kD1</Property></Properties></Link><Link name="link4"><Properties><Property name="active">true</Property><Property name="from">..\\kD2</Property><Property name="to">.\\kD2</Property></Properties></Link></Links><AssociatedFiles/></Component><Variable name="D_1in" state="Input" type="double">0<Properties><Property name="index">1</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">false</Property></Properties></Variable><Variable name="D_w" state="Input" type="double">0<Properties><Property name="index">2</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Variable name="l" state="Input" type="double">0<Properties><Property name="index">3</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Variable name="kD1" state="Input" type="double">0<Properties><Property name="index">4</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Variable name="kD2" state="Input" type="double">0<Properties><Property name="index">5</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Variable name="powerMax" state="Output" type="double">0<Properties><Property name="index">6</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Variable name="omegaMax" state="Output" type="double">0<Properties><Property name="index">7</Property><Property name="description"></Property><Property name="upperBound">0</Property><Property name="hasUpperBound">false</Property><Property name="lowerBound">0</Property><Property name="hasLowerBound">false</Property><Property name="units"></Property><Property name="enumeratedValues"></Property><Property name="enumeratedAliases"></Property><Property name="validity">true</Property></Properties></Variable><Links><Link name="link0"><Properties><Property name="active">true</Property><Property name="from">.\\Script.powerMax</Property><Property name="to">.\\powerMax</Property></Properties></Link><Link name="link1"><Properties><Property name="active">true</Property><Property name="from">.\\Script.omegaMax</Property><Property name="to">.\\omegaMax</Property></Properties></Link></Links><AssociatedFiles/></Assembly><Extensions><Compatibilities xml:space="preserve"><Compatibility versionLessThan="9.0">This model was originally saved in ModelCenter 9.0 or greater. Data will be lost if this model is saved in this version of ModelCenter.</Compatibility></Compatibilities></Extensions></Model><Classes/></File>